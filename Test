string targetPortfolio = "TargetPortfolioName";
DateTime fromDate = new DateTime(2023, 01, 01);
DateTime toDate = new DateTime(2023, 01, 31);

var aggregatedSums = await context.CalculationDetails
    .Join(context.Calculations,
          detail => detail.CalculationId,
          calc => calc.Id,
          (detail, calc) => new { Detail = detail, Calc = calc })
    .Where(x => x.Calc.Portfolio == targetPortfolio &&
                x.Calc.BusinessDate >= fromDate &&
                x.Calc.BusinessDate <= toDate)
    .Where(x => x.Calc.CalculationTimestamp == context.Calculations
        .Where(c2 => c2.BusinessDate == x.Calc.BusinessDate && 
                     c2.Portfolio == targetPortfolio)
        .Max(c2 => c2.CalculationTimestamp))
    .GroupBy(x => 1)
    .Select(g => new
    {
        TotalFrenchRC = g.Sum(x => x.Detail.FrenchRC),
        TotalFrenchPandL = g.Sum(x => x.Detail.FrenchPandL),
        TotalIrfsPandL = g.Sum(x => x.Detail.IrfsPandL)
    })
    .FirstOrDefaultAsync();
